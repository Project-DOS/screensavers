import{A as t,B as e,f as i,m as s,n as o,P as n,h as a,i as r,j as h,p as d}from"./trois.module.b64db74f.js";import{s as m}from"./simplex-noise.ac12df8c.js";import{r as p,o as l,c,w as u,b as f}from"./app.c4cbb42c.js";const g=new m,I={components:{AmbientLight:t,BoxGeometry:e,Camera:i,InstancedMesh:s,PhongMaterial:o,Plane:n,PointLight:a,Renderer:r,Scene:h},setup:()=>({SIZE:1.5,NX:20,NY:20,PADDING:1,SIZEP:2.5,W:49,H:49,NUM_INSTANCES:400}),data:()=>({}),mounted(){this.renderer=this.$refs.renderer,this.pointer=this.renderer.three.pointer,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.dummy=new d,this.renderer.onBeforeRender(this.animate)},methods:{animate(){this.light.position.x=this.pointer.positionV3.x,this.light.position.y=this.pointer.positionV3.y,this.updateInstanceMatrix()},updateInstanceMatrix(){const t=-this.W/2+this.PADDING,e=-this.H/2+this.PADDING,i=1e-4*Date.now(),s=.1*this.pointer.positionN.x,o=.1*this.pointer.positionN.y;let n,a,r,h,d,m;for(let p=0;p<this.NX;p++)for(let l=0;l<this.NY;l++)n=t+p*this.SIZEP,a=e+l*this.SIZEP,r=.005*n+s,h=.005*a+o,d=g.noise3D(r,h,i)*Math.PI,m=g.noise3D(h,r,i)*Math.PI,this.dummy.position.set(n,a,-10),this.dummy.rotation.set(d,m,0),this.dummy.updateMatrix(),this.imesh.setMatrixAt(p*this.NY+l,this.dummy.matrix);this.imesh.instanceMatrix.needsUpdate=!0}}};I.render=function(t,e,i,s,o,n){const a=p("Camera"),r=p("AmbientLight"),h=p("PointLight"),d=p("BoxGeometry"),m=p("PhongMaterial"),g=p("InstancedMesh"),I=p("Plane"),N=p("Scene"),P=p("Renderer");return l(),c(P,{ref:"renderer",antialias:"",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05},pointer:"",shadow:""},{default:u((()=>[f(a,{position:{z:20}}),f(N,null,{default:u((()=>[f(r,{color:"#808080"}),f(h,{ref:"light","cast-shadow":"","shadow-map-size":{width:1024,height:1024}},null,512),f(g,{ref:"imesh",count:s.NUM_INSTANCES,"cast-shadow":"","receive-shadow":""},{default:u((()=>[f(d,{size:s.SIZE},null,8,["size"]),f(m,{color:"#9C1E15"})])),_:1},8,["count"]),f(I,{width:2*s.W,height:2*s.H,position:{z:-10-s.SIZE},"receive-shadow":""},{default:u((()=>[f(m,{color:"#9C1E15"})])),_:1},8,["width","height","position"])])),_:1})])),_:1},8,["orbit-ctrl"])};export default I;
