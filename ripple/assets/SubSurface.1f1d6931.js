import{f as t,a1 as e,E as s,F as a,m as i,h as r,i as o,o as n,a2 as m,j as h,U as c,p as d,q as l,a3 as u,v as p,r as f}from"./trois.module.b64db74f.js";import{z as y,r as C,o as S,c as g,w as b,b as M}from"./app.c4cbb42c.js";const{randFloat:N,randFloatSpread:A}=f,x={components:{Camera:t,DodecahedronGeometry:e,EffectComposer:s,FXAAPass:a,InstancedMesh:i,PointLight:r,Renderer:o,RenderPass:n,SubSurfaceMaterial:m,Scene:h,UnrealBloomPass:c},setup(){const t=[],e=y.scale(["#dd3e1b","#0b509c"]),s=new l,a=new d,i=new l;for(let r=0;r<2e3;r++)t.push({position:new l(A(200),A(200),A(200)),scale:N(.2,1),velocity:new l(A(2),A(2),A(2)),attraction:.0025+N(0,.01),vlimit:.3+N(0,.2)});return{NUM_INSTANCES:2e3,instances:t,cscale:e,target:s,dummyO:a,dummyV:i}},mounted(){this.renderer=this.$refs.renderer,this.imesh=this.$refs.imesh.mesh,this.light=this.$refs.light.light,this.init()},methods:{init(){for(let t=0;t<this.NUM_INSTANCES;t++){const{position:e,scale:s}=this.instances[t];this.dummyO.position.copy(e),this.dummyO.scale.set(s,s,s),this.dummyO.updateMatrix(),this.imesh.setMatrixAt(t,this.dummyO.matrix)}this.updateColors(),this.imesh.instanceMatrix.needsUpdate=!0,this.renderer.onBeforeRender(this.animate)},animate(){const{pointer:t}=this.renderer.three;this.target.copy(t.positionV3),this.light.position.copy(this.target);for(let e=0;e<this.NUM_INSTANCES;e++){const{position:t,scale:s,velocity:a,attraction:i,vlimit:r}=this.instances[e];this.dummyV.copy(this.target).sub(t).normalize().multiplyScalar(i),a.add(this.dummyV).clampScalar(-r,r),t.add(a),this.dummyO.position.copy(t),this.dummyO.scale.set(s,s,s),this.dummyO.lookAt(this.dummyV.copy(t).add(a)),this.dummyO.updateMatrix(),this.imesh.setMatrixAt(e,this.dummyO.matrix)}this.imesh.instanceMatrix.needsUpdate=!0},randomColors(){const t=y.random(),e=y.random();this.cscale=y.scale([t,e]),this.updateColors()},updateColors(){const t=[];for(let e=0;e<this.NUM_INSTANCES;e++){const e=new u(this.cscale(N(0,1)).hex());t.push(e.r,e.g,e.b)}this.imesh.geometry.setAttribute("color",new p(new Float32Array(t),3))}}};x.render=function(t,e,s,a,i,r){const o=C("Camera"),n=C("PointLight"),m=C("DodecahedronGeometry"),h=C("SubSurfaceMaterial"),c=C("InstancedMesh"),d=C("Scene"),l=C("RenderPass"),u=C("UnrealBloomPass"),p=C("FXAAPass"),f=C("EffectComposer"),y=C("Renderer");return S(),g(y,{ref:"renderer",resize:"","orbit-ctrl":{enableDamping:!0,dampingFactor:.05},pointer:"",onClick:r.randomColors},{default:b((()=>[M(o,{position:{z:200}}),M(d,null,{default:b((()=>[M(n,{ref:"light",color:"#FFC0C0"},null,512),M(c,{ref:"imesh",count:a.NUM_INSTANCES},{default:b((()=>[M(m,{radius:5}),M(h,{props:{vertexColors:!0}})])),_:1},8,["count"])])),_:1}),M(f,null,{default:b((()=>[M(l),M(u,{strength:.5},null,8,["strength"]),M(p)])),_:1})])),_:1},8,["orbit-ctrl","onClick"])};export default x;
